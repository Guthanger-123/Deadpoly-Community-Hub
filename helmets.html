<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DeadPoly Community Hub ‚Äî Helmets</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GD7LNZHQMM"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-GD7LNZHQMM');
  </script>

  <style>
    :root{
      --bg:#0b0b0f;
      --panel:#14141b;
      --panel2:#101016;
      --text:#f2f2f2;
      --muted:#b7b7c2;
      --line:#2a2a36;
      --btn:#1c1c26;
      --btnHover:#242434;
      --glow: rgba(120,140,255,.18);
      --cardGlow: rgba(255,255,255,.05);
    }

    html,body{
      height:100%;
      margin:0;
      background:radial-gradient(900px 520px at 40% 8%, var(--glow), transparent 55%), var(--bg);
      color:var(--text);
      font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    a{color:inherit}

    /* ===== Top Bar (same vibe) ===== */
    .topbar{
      position:sticky; top:0; z-index:1000;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:12px;
      padding:12px 16px;
      background: rgba(10,10,10,.72);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .topbar-title{
      justify-self:center;
      color:#cfcfcf;
      font: 13px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      letter-spacing:.4px;
      display:flex; gap:10px; align-items:center;
    }
    .topbar-left{justify-self:start; display:flex; gap:10px; align-items:center;}
    .topbar-right{justify-self:end; display:flex; gap:10px; align-items:center;}
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:7px 12px;
      border-radius:10px;
      text-decoration:none;
      color:#e9e9e9;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      font: 12px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      transition: transform .12s ease, background .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{ background: rgba(255,255,255,.10); transform: translateY(-1px); }
    .btn:active{ transform: translateY(0px) scale(.99); }

    /* ===== Layout ===== */
    .wrap{
      max-width: 1320px;
      margin: 0 auto;
      padding: 14px 14px 36px;
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:14px;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr; }
    }

    /* ===== Panels ===== */
    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.035), rgba(255,255,255,.01));
      border: 1px solid rgba(255,255,255,.09);
      border-radius: 18px;
      box-shadow: 0 14px 44px rgba(0,0,0,.45);
    }
    .p-hd{
      padding:14px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .p-hd h2{margin:0;font-size:14px;letter-spacing:.4px}
    .p-hd .sub{margin-top:4px;color:var(--muted);font-size:12px}

    /* ===== Left accordion ===== */
    .acc{padding:10px}
    .acc details{
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.22);
      border-radius: 14px;
      margin: 10px 0;
      overflow:hidden;
    }
    .acc summary{
      list-style:none;
      cursor:pointer;
      padding:12px 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-weight:700;
    }
    .acc summary::-webkit-details-marker{display:none;}
    .acc .acc-body{
      padding: 0 12px 12px;
      color:var(--muted);
      font-size:12px;
    }
    .chiprow{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{
      display:inline-flex; align-items:center; gap:6px;
      padding:7px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      text-decoration:none;
      color:#e9e9e9;
      font-size:12px;
      transition: background .12s ease, transform .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .chip:hover{background: rgba(255,255,255,.10); transform: translateY(-1px);}

    /* ===== Main ===== */
    .main{ padding:14px; display:grid; gap:14px; }

    .hero{
      padding:16px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(900px 500px at 10% 0%, rgba(90,110,255,.22), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.015));
      box-shadow: 0 18px 60px rgba(0,0,0,.48);
    }
    .hero h1{margin:0;font-size:22px;letter-spacing:.2px}
    .hero p{margin:8px 0 0;color:var(--muted);max-width: 950px;font-size:12.5px}
    .hero .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:12px;}

    .searchbar{
      margin-top:12px;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .searchbar input{
      flex:1; min-width: 260px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 12px;
      padding:10px 12px;
      color:var(--text);
      outline:none;
    }
    .searchbar input:focus{
      border-color: rgba(150,170,255,.35);
      box-shadow: 0 0 0 3px rgba(120,140,255,.12);
    }
    .hint{color:var(--muted);font-size:12px}

    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      padding:12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
    }
    .pill{
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color:#e9e9e9;
      font-size:12px;
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, background .12s ease;
      white-space:nowrap;
    }
    .pill:hover{background: rgba(255,255,255,.10); transform: translateY(-1px);}
    .pill.active{outline:2px solid rgba(120,140,255,.22);}

    .sectionTitle{
      display:flex; justify-content:space-between; align-items:flex-end;
      gap:12px; flex-wrap:wrap;
      padding: 0 2px;
    }
    .sectionTitle h2{margin:0;font-size:13px;letter-spacing:.35px}
    .divider{height:1px;background: rgba(255,255,255,.08);margin: 4px 0 0;border-radius:999px;}

    /* ===== Helmet cards ===== */
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap:12px;
    }
    .card{
      padding:12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      position:relative;
      overflow:hidden;
      display:flex;
      gap:12px;
      align-items:flex-start;
      min-height: 92px;
    }
    .card:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(320px 120px at 10% 0%, var(--cardGlow), transparent 60%);
      pointer-events:none;
    }
    .icon{
      width:52px; height:52px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      flex:0 0 auto;
      display:grid;
      place-items:center;
      overflow:hidden;
      position:relative;
      z-index:1;
    }
    .icon img{width:100%; height:100%; object-fit:cover; display:block;}
    .badge{
      font-weight:800;
      letter-spacing:.5px;
      opacity:.9;
    }
    .meta{position:relative; z-index:1; flex:1;}
    .meta h3{margin:0 0 4px;font-size:13px;letter-spacing:.2px}
    .meta .subline{color:var(--muted);font-size:12px}
    .meta .notes{margin-top:8px;color:#d7d7df;opacity:.95;font-size:12px}
    .meta .links{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    .smallbtn{
      display:inline-flex;align-items:center;justify-content:center;
      padding:6px 9px;border-radius:10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      text-decoration:none;
      font-size:12px;
      transition: transform .12s ease, background .12s ease;
      user-select:none;
    }
    .smallbtn:hover{background: rgba(255,255,255,.10); transform: translateY(-1px);}

    /* ===== Table view ===== */
    .tableWrap{overflow:auto;border-radius:16px;border:1px solid rgba(255,255,255,.10);background: rgba(0,0,0,.20);}
    table{border-collapse:collapse;min-width:920px;width:100%;}
    th,td{padding:10px 10px;border-bottom:1px solid rgba(255,255,255,.08);text-align:left;vertical-align:top;font-size:12.5px;}
    th{position:sticky;top:0;background: rgba(10,10,10,.75);backdrop-filter: blur(8px);z-index:2;font-size:12px;letter-spacing:.3px;}
    tr:hover td{background: rgba(255,255,255,.03);}
    .tIcon{width:42px;height:42px;border-radius:10px;border:1px solid rgba(255,255,255,.10);overflow:hidden;background: rgba(0,0,0,.25);display:grid;place-items:center;}
    .tIcon img{width:100%;height:100%;object-fit:cover;display:block;}

    /* Utility */
    .hide{display:none !important;}
    .statbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;color:var(--muted);font-size:12px}
    .kpi{
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color:#e9e9e9;
    }
  </style>
</head>

<body>
  <!-- TOP BAR -->
  <div class="topbar">
    <div class="topbar-left">
      <a class="btn" href="wiki.html">‚Üê Wiki</a>
      <a class="btn" href="index.html">Menu</a>
    </div>

    <div class="topbar-title">
      <strong>Helmets</strong>
      <span style="opacity:.65">Database</span>
    </div>

    <div class="topbar-right">
      <a class="btn" href="tips.html">Tips</a>
      <a class="btn" href="map.html">Maps</a>
    </div>
  </div>

  <div class="wrap">

    <!-- LEFT -->
    <aside class="panel">
      <div class="p-hd">
        <h2>Helmet Pages</h2>
        <div class="sub">Local database + fast exits to official/community pages.</div>
      </div>
      <div class="acc">
        <details open>
          <summary>
            Helmets (You are here)
            <span>+</span>
          </summary>
          <div class="acc-body">
            Use search + filters on the right.
            <div class="chiprow">
              <a class="chip" href="#cards">Card view</a>
              <a class="chip" href="#table">Table view</a>
              <a class="chip" href="https://deadpoly.wiki/Helmets" target="_blank" rel="noopener">Official Helmets ‚Üó</a>
              <a class="chip" href="https://deadpoly.fandom.com/wiki/Deadpoly_(Rebuild)_Wiki" target="_blank" rel="noopener">Rebuild TOC ‚Üó</a>
            </div>
          </div>
        </details>

        <details>
          <summary>
            Next pages to build
            <span>+</span>
          </summary>
          <div class="acc-body">
            Same layout, new data source.
            <div class="chiprow">
              <a class="chip" href="weapons.html">Weapons (next)</a>
              <a class="chip" href="masks.html">Masks</a>
              <a class="chip" href="armor.html">Armor</a>
              <a class="chip" href="ammo.html">Ammo</a>
            </div>
          </div>
        </details>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <section class="hero">
        <h1>Helmets</h1>
        <p>
          This page is generated from your pasted helmet table markup (Rebuild/community format) and presented cleanly.
          It supports fast search, view toggles, and links out to the correct wiki pages.
        </p>

        <div class="row">
          <a class="btn" href="https://deadpoly.wiki/Helmets" target="_blank" rel="noopener">Official Helmets ‚Üó</a>
          <a class="btn" href="https://deadpoly.fandom.com/wiki/Deadpoly_(Rebuild)_Wiki" target="_blank" rel="noopener">Rebuild TOC ‚Üó</a>
        </div>

        <div class="searchbar">
          <input id="q" placeholder="Search helmets (ex: raid, hard hat, trooper, offroad, firefighter)..." />
          <span class="hint">Search matches name + notes + armor</span>
        </div>

        <div class="statbar" style="margin-top:10px">
          <span class="kpi" id="countKpi">Loading‚Ä¶</span>
          <span class="kpi" id="shownKpi">‚Äî</span>
        </div>
      </section>

      <section class="toolbar">
        <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
          <span class="hint" style="margin-right:6px">View</span>
          <button class="pill active" id="viewCardsBtn">Cards</button>
          <button class="pill" id="viewTableBtn">Table</button>
        </div>

        <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
          <span class="hint" style="margin-right:6px">Quick filters</span>
          <button class="pill active" data-filter="all">All</button>
          <button class="pill" data-filter="raid">Raid</button>
          <button class="pill" data-filter="military">Military</button>
          <button class="pill" data-filter="football">Football</button>
          <button class="pill" data-filter="hard hat">Hard Hat</button>
          <button class="pill" data-filter="offroad">Offroad</button>
          <button class="pill" data-filter="fire fighter">Fire Fighter</button>
        </div>
      </section>

      <section id="cards">
        <div class="sectionTitle">
          <h2>Card View</h2>
          <div class="hint">Fast scanning + click out to wiki pages.</div>
        </div>
        <div class="divider"></div>
        <div class="grid" id="cardsGrid" style="margin-top:12px"></div>
      </section>

      <section id="table">
        <div class="sectionTitle">
          <h2>Table View</h2>
          <div class="hint">Simple list, copy-friendly.</div>
        </div>
        <div class="divider"></div>

        <div class="tableWrap" style="margin-top:12px">
          <table>
            <thead>
              <tr>
                <th style="width:62px">Icon</th>
                <th>Name</th>
                <th style="width:120px">Armor</th>
                <th>Notes</th>
                <th style="width:160px">Links</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </section>

    </main>
  </div>

<script>
  /**
   * Data source: your pasted "wikitable" markup.
   * This is parsed into rows: icon-file, name/link, armor, notes.
   */
  const helmetsWikiTable = String.raw`{| class="wikitable sortable"
|-
|+ !!REBUILD!!
!  !! Name !! Armor !! Notes
|-
| [[File:TM_HaloMK5_Blue_I.png]] || [[Mk V Helmets | Mk V Spartan Helmet (Blue)]] || 1-15 || Comes in 2 other colors
|-
| [[File:TM_HaloMK5_Green_I.png]] || [[Mk V Helmets | Mk V Spartan Helmet (Green)]] || 1-15 || Comes in 2 other colors
|-
| [[File:TM_HaloMK5_Red_I.png]] || [[Mk V Helmets | Mk V Spartan Helmet (Red)]] || 1-15 || Comes in 2 other colors
|-
| [[File:TM_HatChef_I.png]] || Chef Hat || ?? || Its the hat of a chef
|-
| [[File:TM_HeavyHelmet_I.png]] || Heavy Helmet || 1-15 || Pretty gnarly looking viking helmet
|-
| [[File:TM_HelmetCenturion_1_Blue_I.png]] || [[Centurion | Centurion Helmet (Blue)]] || 1-15 || Comes in 1 other color
|-
| [[File:TM_HelmetCenturion_1_Red_I.png]] || [[Centurion | Centurion Helmet (Red)]] || 1-15 || Comes in 1 other color
|-
| [[File:TM_HelmetCenturion_2_Blue_I.png]] || [[Centurion | Centurion Helmet (Blue)]] || 1-15 || Comes in 1 other color
|-
| [[File:TM_HelmetCenturion_2_Red_I.png]] || [[Centurion | Centurion Helmet (Red)]] || 1-15 || Comes in 1 other color
|-
| [[File:TM_HelmetCenturion_3_Blue_I.png]] || [[Centurion | Centurion Helmet (Blue)]] || 1-15 || Comes in 1 other color
|-
| [[File:TM_HelmetCenturion_3_Red_I.png]] || [[Centurion | Centurion Helmet (Red)]] || 1-15 || Comes in 1 other color
|-
|[[File:TM_HelmetClown_I.png]] || Clown Mask || 1-15 || Hi Georgie!
|-
|[[File:TM_HelmetCrown_I.png]] || Crown || 1-15 || Long live the King!
|-
|[[File:TM_HelmetDaft_I.png]] || Daft Punk|| 1-15 || Like the legend of the Pheonix
|-
|[[File:TM_HelmetDeadmau5_I.png]] || Dead Mau5 || 1-15 || Marshmello Ripoff?
|-
|[[File:TM_HelmetFirefighter_1_I.png]] || [[Fire Fighter | Fire Fighter Helmet (Red)]] || 1-15 || Comes in 2 other colors
|-
|[[File:TM_HelmetFirefighter_2_I.png]] || [[Fire Fighter | Fire Fighter Helmet (Red)]] || 1-15 || Comes in 2 other colors
|-
|[[File:TM_HelmetFirefighter_3_I.png]] || [[Fire Fighter | Fire Fighter Helmet (Red)]] || 1-15 || Comes in 2 other colors
|-
|[[File:TM_HelmetFootball_1_I.png]] || [[Football Helmets | Football Helmet (Red w/ blue stripes)]] || 1-15 || Comes in 3 other colors
|-
|[[File:TM_HelmetFootball_2_I.png]] || [[Football Helmets | Football Helmet (Black w/ red stripes)]] || 1-15 || Comes in 3 other colors
|-
|[[File:TM_HelmetFootball_3_I.png]] || [[Football Helmets | Football Helmet (White w/ black stripes)]] || 1-15 || Comes in 3 other colors
|-
|[[File:TM_HelmetFootball_4_I.png]] || [[Football Helmets | Football Helmet (Yellow w/ purple stripes)]] || 1-15 || Comes in 3 other colors
|-
|[[File:TM_HelmetFootballMod_1_I.png]] || [[Football Helmets | Football Helmet (Purple w/ yellow stripes)]] || 1-15 || Modded out apocalypse helmet
|-
|[[File:TM_HelmetFootballMod_2_I.png]] || [[Football Helmets | Football Helmet (Yellow w/ purple stripes)]] || 1-15 || Modded out apocalypse helmet
|-
|[[File:TM_HelmetFootballMod_3_I.png]] || [[Football Helmets | Football Helmet (Blue w/ green stripes)]] || 1-15 || Modded out apocalypse helmet
|-
|[[File:TM_HelmetFootballMod_4_I.png]] || [[Football Helmets | Football Helmet (Orange w/ green stripes)]] || 1-15 || Modded out apocalypse helmet
|-
|[[File:TM_HelmetFootballMod_5_I.png]] || [[Football Helmets | Football Helmet (Red w/ green stripes)]] || 1-15 || Modded out apocalypse helmet
|-
|[[File:TM_HelmetHardHat_1_E.png]] || [[Hard Hats | Hard Hat (Orange)]] || 1-15 || Construction Hat
|-
|[[File:TM_HelmetHardHat_2_E.png]] || [[Hard Hats | Hard Hat (Blue)]] || 1-15 || Construction Hat
|-
|[[File:TM_HelmetHardHat_3_E.png]] || [[Hard Hats | Hard Hat (Green)]] || 1-15 || Construction Hat
|-
|[[File:TM_HelmetHardHat_4_E.png]] || [[Hard Hats | Hard Hat (White)]] || 1-15 || Construction Hat
|-
|[[File:TM_HelmetKabuto_I.png]] || Kabuto Helmet || 1-15 || Typical helmet you'd see a samurai wearing
|-
|[[File:TM_HelmetKnight_1_I.png]] || [[Knight Helmets | Knight Helmet (Red Striped)]] || 1-15 || The Helmet worn by a Knight
|-
|[[File:TM_HelmetKnight_2_I.png]] || [[Knight Helmets | Knight Helmet (Blue Striped)]] || 1-15 || The Helmet worn by a Knight
|-
|[[File:TM_HelmetKnight_3_I.png]] || [[Knight Helmets | Knight Helmet (Green Striped)]] || 1-15 || The Helmet worn by a Knight
|-
|[[File:TM_HelmetKnight_4_I.png]] || [[Knight Helmets | Knight Helmet (Black)]] || 1-15 || Not a reference to Fortnite or anything üëÄ
|-
|[[File:TM_HelmetKnight_5_I.png]] || [[Knight Helmets | Knight Helmet (Tan)]] || 1-15 || The Helmet worn by a Knight
|-
|[[File:TM_HelmetKnight_6_I.png]] || [[Knight Helmets | Knight Helmet (Purple Striped)]] || 1-15 || The Helmet worn by a Knight
|-
|[[File:TM_HelmetMando_I.png]] ||  Mandalorian Helmet || 1-15 || This is the way, made of the finest Beskar in the galaxy
|-
|[[File:TM_HelmetMarshmello_I.png]] || Marshmello Mask || 1-15 || Better than DeadMau5
|-
|[[File:TM_HelmetMegaMan_I.png]] || Mega Man Helmet || 1-15|| Made the foundation of all of our childhoods
|-
|[[File:TM_MilitaryBlack_I.png]] || [[Military Helmets | Military Helmet (Black)]] || 1-15 || A modern military grade helmet.
|-
|[[File:TM_MilitaryGreen_I.png]] || [[Military Helmets | Military Helmet (Black)]] || 1-15 || A modern military grade helmet.
|-
|[[File:TM_HelmetMilitaryAce_1_I.png]] || [[Military Helmets | Military Helmet (Green)]] || 1-15 || A helmet that looks like its from the Vietnam Era
|-
|[[File:TM_HelmetMilitaryAce_2_I.png]] || [[Military Helmets | Military Helmet (Tan)]] || 1-15 || A helmet that looks like its from the Vietnam Era
|-
|[[File:TM_HelmetMilitaryAce_3_I.png]] || [[Military Helmets | Military Helmet (Black)]] || 1-15 || A helmet that looks like its from the Vietnam Era
|-
|[[File:TM_HelmetMilitaryGhillie_1_I.png]] || [[Military Helmets | Ghili Military Helmet (Tan)]] || 1-15 || A helmet meant to camouflage you
|-
|[[File:TM_HelmetMilitaryGhillie_2_I.png]] || [[Military Helmets | Ghili Military Helmet (Black)]] || 1-15 || A helmet meant to camouflage you
|-
|[[File:TM_HelmetMilitaryGhillie_3_I.png]] || [[Military Helmets | Ghili Military Helmet (Grey)]] || 1-15 || A helmet meant to camouflage you
|-
|[[File:TM_HelmetMilitaryGhillie_4_I.png]] || [[Military Helmets | Ghili Military Helmet (Green/Brown)]] || 1-15 || A helmet meant to camouflage you
|-
|[[File:TM_HelmetOffroad_1_I.png]] || [[Offroad Helmets| Offroad Helmet (Red)]] || 1-15 || A helmet to protect your head
|-
|[[File:TM_HelmetOffroad_2_I.png]] || [[Offroad Helmets| Offroad Helmet (White)]] || 1-15 || A helmet to protect your head
|-
|[[File:TM_HelmetOffroad_3_I.png]] || [[Offroad Helmets| Offroad Helmet (Green)]] || 1-15 || A helmet to protect your head
|-
|[[File:TM_HelmetOffroad_4_I.png]] || [[Offroad Helmets| Offroad Helmet (Blue)]] || 1-15 || A helmet to protect your head
|-
|[[File:TM_HelmetOffroad_5_I.png]] || [[Offroad Helmets| Offroad Helmet (Purple)]] || 1-15 || A helmet to protect your head
|-
|[[File:TM_HelmetOffroad_6_I.png]] || [[Offroad Helmets| Offroad Helmet (Yellow)]] || 1-15 || A helmet to protect your head
|-
|[[File:TM_HelmetPumkin_E.png]] || Pumpkin Head || 1-15 || A pumpkin helmet that comes around every halloween.
|-
|[[File:TM_HelmetRacer_1_I.png]] || [[Racer Helmets | Racer Helmet (White w/ Red Stripes)]] || 1-15 || A good helmet for races.
|-
|[[File:TM_HelmetRacer_2_I.png]] || [[Racer Helmets | Racer Helmet (White w/ Blue Stripes)]] || 1-15 || A good helmet for races.
|-
|[[File:TM_HelmetRacer_3_I.png]] || [[Racer Helmets | Racer Helmet (White w/ Green Stripes)]] || 1-15 || A good helmet for races.
|-
|[[File:TM_HelmetRacer_4_I.png]] || [[Racer Helmets | Racer Helmet (Black w/ Yellow Stripes)]] || 1-15 || A good helmet for races.
|-
|[[File:TM_HelmetRaidBlack_I.png]] || [[Raid Helmets | Raid Helmet (Black)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetRaidGray_I.png]] || [[Raid Helmets | Raid Helmet (Grey)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetRaidGreen_I.png]] || [[Raid Helmets | Raid Helmet (Green)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetRaidTan_I.png]] || [[Raid Helmets | Raid Helmet (Tan)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetRaidBlack_2_I.png]] || [[Raid Helmets | Raid Helmet (Black w/ Gold Spikes)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetRaidRed_I.png]] || [[Raid Helmets | Raid Helmet (Red w/ Black Spikes)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetRaidTan_2_I.png]] || [[Raid Helmets | Raid Helmet (Tan w/ Gold Spikes)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetRaidSilver_I.png]] || [[Raid Helmets | Raid Helmet (Silver w/ Black Spikes)]] || 1-15 || A heavy duty welding face mask, great for deflecting bullets.
|-
|[[File:TM_HelmetTrooper_I.png]] || [[Trooper Helmets | Trooper Helmet]] || 1-15 || Comes in 1 other higher value variant
|-
|[[File:TM_HelmetTrooperBlood_I.png]] || [[Trooper Helmets | Trooper Helmet]] || 1-15 || Comes in 1 other lower value variant
|}`;

  // ---------- Parsing helpers ----------
  function stripBrackets(s){
    return (s || "").replace(/\[\[|\]\]/g, "").trim();
  }

  // Extract [[Page | Label]] OR [[Page]] OR plain text
  function parseWikiLink(cell){
    const m = (cell || "").match(/\[\[([^\]]+)\]\]/);
    if(!m) return { page:null, label: stripBrackets(cell) || "" };

    const inner = m[1]; // "Page | Label"
    const parts = inner.split("|").map(x => x.trim());
    const page = parts[0] || null;
    const label = (parts[1] || parts[0] || "").trim();
    return { page, label };
  }

  // Extract File:Something.png from [[File:Something.png]]
  function parseFileName(cell){
    const m = (cell || "").match(/File:([^|\]]+)/i);
    return m ? m[1].trim() : null;
  }

  function normalizePageSlug(page){
    if(!page) return null;
    return page.replace(/ /g, "_").replace(/\u00A0/g, "_");
  }

  // Prefer local images if you add them, else try fandom "Special:FilePath"
  function buildIconCandidates(fileName){
    if(!fileName) return [];
    const local1 = `assets/wiki/helmets/${fileName}`;
    const local2 = `assets/texture/${fileName}`; // just in case you dump icons there
    const fandom = `https://deadpoly.fandom.com/wiki/Special:FilePath/${encodeURIComponent(fileName)}`;
    return [local1, local2, fandom];
  }

  function escapeHtml(s){
    return String(s ?? "").replace(/[&<>"']/g, m => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
    }[m]));
  }

  function parseRowsFromWikiTable(tableText){
    // Split by row markers "|-" then parse lines with "||"
    const chunks = tableText.split("\n|-").map(x => x.trim());
    const rows = [];

    for(const chunk of chunks){
      // rows start with "|" lines that include "||"
      // ignore header rows containing "!":
      if(chunk.includes("!")) continue;

      const line = chunk.split("\n").find(l => l.trim().startsWith("|") && l.includes("||"));
      if(!line) continue;

      // remove leading "|"
      const body = line.replace(/^\|\s*/, "");
      const parts = body.split("||").map(p => p.trim());

      if(parts.length < 3) continue;

      const iconCell = parts[0] || "";
      const nameCell = parts[1] || "";
      const armorCell = parts[2] || "";
      const notesCell = parts[3] || "";

      const fileName = parseFileName(iconCell);
      const link = parseWikiLink(nameCell);

      rows.push({
        fileName,
        name: link.label || stripBrackets(nameCell),
        page: link.page,
        armor: stripBrackets(armorCell),
        notes: stripBrackets(notesCell)
      });
    }

    // Remove obvious duplicates by name+file
    const seen = new Set();
    return rows.filter(r => {
      const key = (r.name + "|" + (r.fileName || "")).toLowerCase();
      if(seen.has(key)) return false;
      seen.add(key);
      return true;
    });
  }

  // ---------- Render ----------
  const allHelmets = parseRowsFromWikiTable(helmetsWikiTable);

  const qEl = document.getElementById("q");
  const cardsGrid = document.getElementById("cardsGrid");
  const tableBody = document.getElementById("tableBody");
  const countKpi = document.getElementById("countKpi");
  const shownKpi = document.getElementById("shownKpi");

  countKpi.textContent = `${allHelmets.length} helmets loaded`;

  let activeFilter = "all";
  let viewMode = "cards";

  function matchesFilter(h){
    if(activeFilter === "all") return true;
    const hay = `${h.name} ${h.notes}`.toLowerCase();
    return hay.includes(activeFilter);
  }

  function matchesQuery(h, q){
    if(!q) return true;
    const hay = `${h.name} ${h.armor} ${h.notes}`.toLowerCase();
    return hay.includes(q.toLowerCase());
  }

  function buildFandomPageUrl(page){
    const slug = normalizePageSlug(page);
    if(!slug) return null;
    return `https://deadpoly.fandom.com/wiki/${encodeURIComponent(slug)}`;
  }

  function render(){
    const q = qEl.value.trim();
    const filtered = allHelmets.filter(h => matchesFilter(h) && matchesQuery(h, q));

    shownKpi.textContent = `${filtered.length} shown`;

    // ----- cards -----
    cardsGrid.innerHTML = "";
    for(const h of filtered){
      const candidates = buildIconCandidates(h.fileName);
      const fandomUrl = buildFandomPageUrl(h.page);

      const card = document.createElement("div");
      card.className = "card";
      card.dataset.name = (h.name || "").toLowerCase();

      // icon: attempt load from candidates
      const iconHtml = candidates.length
        ? `<img alt="${escapeHtml(h.name)}" data-candidates="${escapeHtml(JSON.stringify(candidates))}">`
        : `<div class="badge">${escapeHtml((h.name || "?").slice(0,1).toUpperCase())}</div>`;

      card.innerHTML = `
        <div class="icon">${iconHtml}</div>
        <div class="meta">
          <h3>${escapeHtml(h.name || "(unnamed)")}</h3>
          <div class="subline">Armor: <b>${escapeHtml(h.armor || "‚Äî")}</b></div>
          ${h.notes ? `<div class="notes">${escapeHtml(h.notes)}</div>` : ``}
          <div class="links">
            ${fandomUrl ? `<a class="smallbtn" href="${fandomUrl}" target="_blank" rel="noopener">Open page ‚Üó</a>` : ``}
            ${h.fileName ? `<a class="smallbtn" href="https://deadpoly.fandom.com/wiki/Special:FilePath/${encodeURIComponent(h.fileName)}" target="_blank" rel="noopener">Icon ‚Üó</a>` : ``}
          </div>
        </div>
      `;
      cardsGrid.appendChild(card);
    }

    // ----- table -----
    tableBody.innerHTML = "";
    for(const h of filtered){
      const candidates = buildIconCandidates(h.fileName);
      const fandomUrl = buildFandomPageUrl(h.page);

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>
          <div class="tIcon">
            ${
              candidates.length
                ? `<img alt="${escapeHtml(h.name)}" data-candidates="${escapeHtml(JSON.stringify(candidates))}">`
                : `<div class="badge">${escapeHtml((h.name || "?").slice(0,1).toUpperCase())}</div>`
            }
          </div>
        </td>
        <td><b>${escapeHtml(h.name || "(unnamed)")}</b></td>
        <td>${escapeHtml(h.armor || "‚Äî")}</td>
        <td>${escapeHtml(h.notes || "")}</td>
        <td>
          ${fandomUrl ? `<a class="smallbtn" href="${fandomUrl}" target="_blank" rel="noopener">Page ‚Üó</a>` : ``}
        </td>
      `;
      tableBody.appendChild(tr);
    }

    // Load icons (try local, then fallback)
    hydrateCandidateImages();

    // View mode toggles
    document.getElementById("cards").classList.toggle("hide", viewMode !== "cards");
    document.getElementById("table").classList.toggle("hide", viewMode !== "table");
  }

  function hydrateCandidateImages(){
    const imgs = document.querySelectorAll('img[data-candidates]');
    imgs.forEach(img => {
      if(img.dataset.bound) return;
      img.dataset.bound = "1";
      let candidates;
      try { candidates = JSON.parse(img.getAttribute("data-candidates")); }
      catch(e){ candidates = []; }

      // Try sequentially
      let i = 0;
      const tryNext = () => {
        if(i >= candidates.length){
          // fallback to letter badge by replacing img with text
          const parent = img.parentElement;
          if(parent){
            parent.innerHTML = `<div class="badge">?</div>`;
          }
          return;
        }
        img.src = candidates[i++];
      };
      img.onerror = tryNext;
      tryNext();
    });
  }

  // Filter pills
  const pills = [...document.querySelectorAll(".pill[data-filter]")];
  pills.forEach(p => {
    p.addEventListener("click", () => {
      pills.forEach(x => x.classList.remove("active"));
      p.classList.add("active");
      activeFilter = p.getAttribute("data-filter");
      render();
    });
  });

  // View buttons
  const viewCardsBtn = document.getElementById("viewCardsBtn");
  const viewTableBtn = document.getElementById("viewTableBtn");
  viewCardsBtn.addEventListener("click", () => {
    viewMode = "cards";
    viewCardsBtn.classList.add("active");
    viewTableBtn.classList.remove("active");
    render();
  });
  viewTableBtn.addEventListener("click", () => {
    viewMode = "table";
    viewTableBtn.classList.add("active");
    viewCardsBtn.classList.remove("active");
    render();
  });

  // Search
  qEl.addEventListener("input", render);

  // Initial
  render();
</script>

</body>
</html>
